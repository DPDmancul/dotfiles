#+TITLE:      Neovim
#+AUTHOR:     Davide Peressoni
#+KEYWORDS:   neovim nvim vim vi lua config
#+PROPERTY:   header-args :tangle "~/.config/nvim/init.lua" :mkdirp yes

Set space as leader

#+BEGIN_SRC lua
vim.g.mapleader = ' '
#+END_SRC

* General

#+BEGIN_SRC lua
vim.opt.mouse      = 'a'  -- Enable mouse
vim.opt.lazyredraw = true -- Use lazy redraw
vim.opt.undofile   = true -- Enable persistent undo
vim.opt.hidden     = true -- Allow buffers in background
#+END_SRC

** Autosession

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "rmagatti/auto-session",
  config = function()
    vim.o.sessionoptions="blank,buffers,curdir,folds,help,tabpages,winsize,winpos,terminal"
    require"auto-session".setup{
      auto_session_suppress_dirs = {'~/'}
    }
  end
}
#+END_SRC

Find sessions with Telescope

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "rmagatti/session-lens",
  requires = {"rmagatti/auto-session", "nvim-telescope/telescope.nvim"},
  config = function()
    require("session-lens").setup({})
  end
}
#+END_SRC

* UI

#+BEGIN_SRC lua
vim.opt.termguicolors  = true  -- Enable gui colors
vim.opt.cursorline     = true  -- Enable highlighting of the current line
vim.opt.signcolumn     = "yes" -- Always show signcolumn or it would frequently shift
vim.opt.pumheight      = 10    -- Make popup menu smaller
vim.opt.colorcolumn    = "+1"  -- Draw colored column one step to the right of desired maximum width
vim.opt.linebreak      = true  -- Wrap long lines at 'breakat' (if 'wrap' is set)
vim.opt.scrolloff      = 2     -- Show more lines on top and bottom
vim.opt.title          = true  -- Enable window title
vim.opt.list           = true  -- Show tabs and trailing spaces
#+END_SRC

** Line numbers

Enable relative line numbers

#+BEGIN_SRC lua
vim.opt.number         = true  -- Show line numbers
vim.opt.relativenumber = true  -- Show relative line numbers
vim.opt.numberwidth    = 1     -- Minimum number width
#+END_SRC

Show relative numbers only when needed

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use "jeffkreeftmeijer/vim-numbertoggle"
#+END_SRC

** TODO Conceal

Use conceal to show pretty symbols

#+BEGIN_SRC lua
vim.opt.conceallevel = 2
#+END_SRC


** Theme

Use Gruvbox theme

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "ellisonleao/gruvbox.nvim",
  requires = "rktjmp/lush.nvim",
  config = function ()
    vim.cmd "colorscheme gruvbox"
  end
}
#+END_SRC

** Statusline

Use lualine as statusline, adding =lsp_progress= and an indication on the indentation size and type.

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "nvim-lualine/lualine.nvim",
  requires = {
    "kyazdani42/nvim-web-devicons",
    "arkav/lualine-lsp-progress"
  },
  config = function()
    require"lualine".setup{
      options = {
        section_separators = { left = '', right = ''},
        component_separators = { left = '|', right = '|'}
      },
      sections = {
        lualine_c = {
          "filename",
          "lsp_progress"
        },
        lualine_x = {
          "encoding",
          "fileformat",
          function ()
            if (vim.o.expandtab)
              then
                return vim.o.shiftwidth .. " ␣"
              else
                return vim.o.tabstop .. " ↹"
              end
          end,
          "filetype",
        },
      }
    }
  end
}
#+END_SRC

Hide mode: it is already visible in lualine

#+BEGIN_SRC lua
vim.opt.showmode = false
#+END_SRC

** Bufferline

View buffers as modern "tabs"

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "akinsho/bufferline.nvim",
  requires = "kyazdani42/nvim-web-devicons",
  config = function ()
    require"bufferline".setup{
      options = {
        right_mouse_command = nil,
        middle_mouse_command = "bdelete! %d",
        show_close_icon = false,
        offsets = {
          {
            filetype = "NvimTree",
            text = function()
              return vim.fn.getcwd()
            end,
          }
        }
      }
    }
  end
}
#+END_SRC

** Command and search completion

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "gelguy/wilder.nvim",
  config = function ()
    vim.cmd [[
      call wilder#setup({'modes': [':', '/', '?']})
    ]]
  end
}
#+END_SRC

** TODO Sidebar dir tree

   TODO fix: [[https://github.com/kyazdani42/nvim-tree.lua/issues/793#issuecomment-985880207]]

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "kyazdani42/nvim-tree.lua",
  requires = "kyazdani42/nvim-web-devicons",
  config = function()
    require"nvim-tree".setup{
      disable_netrw = false, -- for scp
      hijack_netrw = false,
      view = {
        auto_resize = true,
        side = "left",
      }
    }
  end
}
#+END_SRC

** Toggle terminal

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "akinsho/toggleterm.nvim",
  config = function ()
    require("toggleterm").setup{
      open_mapping = [[<c-\>]],
      shade_terminals = false
    }
    function _G.set_terminal_keymaps()
      local opts = {noremap = true, silent = true}
      vim.api.nvim_buf_set_keymap(0, 't', "<esc>", [[<C-\><C-n>]], opts)
      vim.api.nvim_buf_set_keymap(0, 't', "<C-h>", [[<C-\><C-n><C-W>h]], opts)
      vim.api.nvim_buf_set_keymap(0, 't', "<C-j>", [[<C-\><C-n><C-W>j]], opts)
      vim.api.nvim_buf_set_keymap(0, 't', "<C-k>", [[<C-\><C-n><C-W>k]], opts)
      vim.api.nvim_buf_set_keymap(0, 't', "<C-l>", [[<C-\><C-n><C-W>l]], opts)
    end
    vim.cmd("autocmd! TermOpen term://* lua set_terminal_keymaps()")
  end
}
#+END_SRC

** Smooth scroll

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "karb94/neoscroll.nvim",
  config = function()
    require"neoscroll".setup{}
  end
}
#+END_SRC

* Editing

#+BEGIN_SRC lua
vim.opt.whichwrap   = "b,s,h,l,<,>,[,]" -- Allow moving along lines when the start/end is reached
vim.opt.clipboard   = "unnamedplus"     -- sync yank register with system clipboard
#+END_SRC

** Indentation

1. Use =editorconfig= to set indentation
2. If not, try detect used indentation with =sleuth=
3. Fallback to two spaces

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use "gpanders/editorconfig.nvim"
use "tpope/vim-sleuth"
#+END_SRC

#+BEGIN_SRC lua
vim.opt.expandtab   = true    -- Convert tabs to spaces
vim.opt.tabstop     = 2       -- Display 2 spaces for a tab
vim.opt.shiftwidth  = 2       -- Use this number of spaces for indentation
vim.opt.smartindent = true    -- Make indenting smart
vim.opt.autoindent  = true    -- Use auto indent
vim.opt.breakindent = true    -- Indent wrapped lines to match line start
#+END_SRC

** Motion

Allow going past the end of line in visual block mode

#+BEGIN_SRC lua
vim.opt.virtualedit = "block"
#+END_SRC

*** Case motion

Move into CamelCase and snake\under{}case words

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "bkad/CamelCaseMotion",
  config = function()
    vim.g.camelcasemotion_key = '\\'
  end
}
#+END_SRC

*** Goto char across lines

Use f and t across lines

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use "chrisbra/improvedft"
#+END_SRC

** Comments

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use "b3nj5m1n/kommentary"
#+END_SRC

** Edit with sudo

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "lambdalisue/suda.vim",
  setup = function()
    vim.g.suda_smart_edit = 1
  end
}
#+END_SRC

** Parethesis & co.

Autoclose parenthesis and quotes

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "windwp/nvim-autopairs",
  config = function()
    require"nvim-autopairs".setup{}
  end
}
#+END_SRC

Easy add, remove and change parenthesis and quotes

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "blackCauldron7/surround.nvim",
  config = function()
    require"surround".setup {mappings_style = "sandwich"}
  end
}
#+END_SRC

** Table edit

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use "dhruvasagar/vim-table-mode"
#+END_SRC

** Syntax highlighting

Do syntax highlighting via treesitter

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "nvim-treesitter/nvim-treesitter",
  requires = "p00f/nvim-ts-rainbow",
  run = ":TSUpdate",
  config = function ()
    -- add support for Org mode files
    require "nvim-treesitter.parsers".get_parser_configs().org = {
      install_info = {
        url = "https://github.com/milisims/tree-sitter-org",
        revision = "main",
        files = {"src/parser.c", "src/scanner.cc"},
      },
      filetype = "org",
    }
    -- enable all maintained languages
    require"nvim-treesitter.configs".setup {
      ensure_installed = "maintained",
      highlight = {
        enable = true,
        additional_vim_regex_highlighting = true
      },
      ensure_installed = {'org'},
      incremental_selection = { enable = true },
      indentation = { enable = true },
      folding = { enable = true },
      -- rainbow parenthesis match
      rainbow = {
        enable = true,
        extended_mode = true, -- Also highlight non-bracket delimiters like html tags, boolean or table: lang -> boolean
        max_file_lines = nil, -- Do not enable for files with more than n lines, int
      }
    }
  end
}
#+END_SRC

Show color of colors

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "norcalli/nvim-colorizer.lua",
  config = function()
    require"colorizer".setup{}
  end
}
#+END_SRC

Nix expression language highlighting

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use "LnL7/vim-nix"
#+END_SRC

** TODO Format

*** Trailing spaces

Remove trailing spaces on save (except for Markdown)

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use "itspriddle/vim-stripper"
#+END_SRC

*** List formatting

Define pattern for a start of /numbered/ list. This is responsible for correct
formatting of lists inside comments when using ~gq~.
This basically reads as one of:
1. space + character + =.= or =)= + space;
2. space + =-= or =+= or =*= + space.
Source: [[https://stackoverflow.com/a/37172060]]

#+BEGIN_SRC lua
vim.opt.formatlistpat = [[^\\s*\\w\\+[.\)]\\s\\+\\\\|^\\s*[\\-\\+\\*]\\+\\s\\+]]
#+END_SRC

*** Folds

#+BEGIN_SRC lua
vim.opt.foldmethod  = "indent" -- Set 'indent' folding method
vim.opt.foldenable  = false    -- Start with folds opened
#+END_SRC

* Search

#+BEGIN_SRC lua
vim.opt.ignorecase = true -- enable case insensitive search
vim.opt.smartcase  = true -- when using uppercase make case sensitive
vim.opt.incsearch  = true -- Show search results while typing
#+END_SRC

** Fuzzy finder

Use telescope as fuzzy finder

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "nvim-telescope/telescope.nvim",
  requires = {
    "nvim-lua/plenary.nvim",
    "nvim-telescope/telescope-file-browser.nvim",
    { "nvim-telescope/telescope-fzf-native.nvim", run = "make" },
    "nvim-telescope/telescope-symbols.nvim",
    "tknightz/telescope-termfinder.nvim"
  },
  config = function()
    local telescope = require "telescope"
    telescope.load_extension("file_browser")
    telescope.load_extension("projects")
    telescope.load_extension("fzf")
    telescope.load_extension("termfinder")
  end
}
#+END_SRC

* Git

Git easy with +Magit+ Neogit

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "TimUntersberger/neogit",
  requires = {
    "nvim-lua/plenary.nvim",
    "sindrets/diffview.nvim"
  },
  config = function()
    require"neogit".setup{
      integrations = {
        diffview = true
      }
    }
  end
}
#+END_SRC

Show git signs

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "lewis6991/gitsigns.nvim",
  requires ="nvim-lua/plenary.nvim",
  config = function()
    require"gitsigns".setup()
  end
}
#+END_SRC

* Spelling

#+BEGIN_SRC lua
vim.opt.spell        = true
vim.opt.spelllang    = "en,it"    -- Define spelling dictionaries
vim.opt.complete:append "kspell"  -- Add spellcheck options for autocomplete
vim.opt.spelloptions = "camel"    -- Treat parts of camelCase words as separate words
#+END_SRC

* TODO Key mappings

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "folke/which-key.nvim",
  config = function()
    local wk = require "which-key"
    wk.setup{
      spelling = {
        enabled = true,
        suggestions = 10,
      },
      window = {
        margin = { 0, 0, 0, 0 },
        padding = { 1, 0, 1, 0 },
      }
    }
    local function map (t)
      t.noremap = true
      t.silent = true
      return t
    end
    wk.register({
      f = {
        name = "find",
        r = map{"<cmd>Telescope resume<cr>", "Resume search"},
        f = map{"<cmd>Telescope find_files<cr>", "Files"},
        g = map{"<cmd>Telescope live_grep<cr>", "Grep"},
        b = map{"<cmd>Telescope buffers<cr>", "Buffers"},
        h = map{"<cmd>Telescope help_tags<cr>", "Help"},
        p = map{"<cmd>Telescope projects<cr>", "Projects"},
        s = map{function () require("session-lens").search_session() end, "Sessions"},
        e = map{"<cmd>Telescope file_browser<cr>", "Explore"},
        t = map{"<cmd>NvimTreeToggle<cr>", "File tree"},
        ["\\"] = map{"<cmd>Telescope termfinder find<cr>", "Terminals"},
        [":"] = map{"<cmd>Telescope commands<cr>", "Commands"},
        a = map{"<cmd>Telescope<cr>", "All telescopes"},
      },
      g = {
        name = "git",
        g = map{"<cmd>Neogit<cr>", "Neo git"}
      },
      r = {
        name = "reload",
        r = map{"<cmd>e<cr>", "File"},
        c = map{"<cmd>source ~/.config/nvim/init.lua | PackerSync<cr>", "Config"},
      },
      t = {
        name = "table",
        m = "Toggle table mode",
        t = "To table"
      },
      o = {
        name = "org",
        -- TODO
      }
    }, { prefix = "<leader>" })
  end
}
#+END_SRC

* Projects

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "ahmedkhalf/project.nvim",
  config = function()
    require"project_nvim".setup()
  end
}
#+END_SRC

* Languages

Add support for some languages

** LaTeX

Use LaTeX instead of plain TeX

#+BEGIN_SRC lua
vim.g.tex_flavor = "latex"
#+END_SRC

*** VimTeX

To config for =termpdf= on =kitty= see [[https://github.com/camspiers/dotfiles/blob/42316d7d1c14314e9851e1c92349ddb5662dc1b3/files/.config/nvim/init.vim#L609-L628]]

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "lervag/vimtex",
  config = function()
    vim.g.vimtex_view_general_viewer = "okular"
    -- vim.g.vimtex_view_general_options = "--unique file:@pdf\#src:@line@tex"
    -- vim.g.vimtex_view_general_options_latexmk = "--unique"
  end
}
#+END_SRC

** Org Mode

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "nvim-orgmode/orgmode",
  config = function()
    require"orgmode".setup{}
  end
}
use {
  "akinsho/org-bullets.nvim",
  config = function()
    require"org-bullets".setup{}
  end
}
-- use {
--   "lukas-reineke/headlines.nvim",
--   config = function()
--     require"headlines".setup()
--   end,
-- }
#+END_SRC

* TODO LSP

Use the power of Language Server Protocol for a better developing experience

** Symbols outline

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "simrat39/symbols-outline.nvim",
  requires = "neovim/nvim-lspconfig"
}
#+END_SRC

** LSP UI

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "tami5/lspsaga.nvim",
  require = "neovim/nvim-lspconfig",
  config = function()
    require"lspsaga".init_lsp_saga()
  end
}
#+END_SRC

** Config LSP and completion

#+BEGIN_SRC lua :tangle no :noweb-ref plugins
use {
  "neovim/nvim-lspconfig",
  requires = {
    "hrsh7th/nvim-cmp",
    {
      "hrsh7th/cmp-nvim-lsp",
      requires = "hrsh7th/nvim-cmp"
    },
    "saadparwaiz1/cmp_luasnip" ,
    "L3MON4D3/LuaSnip",
    "simrat39/rust-tools.nvim",
    "nvim-orgmode/orgmode"
  },
  config = function ()
    -- Add additional capabilities supported by nvim-cmp
    local capabilities = vim.lsp.protocol.make_client_capabilities()
    capabilities = require"cmp_nvim_lsp".update_capabilities(capabilities)

    -- Set completeopt to have a better completion experience
    vim.o.completeopt = "menuone,noselect"

    --  Keybindings
    local on_attach = function(client, bufnr) -- TODO with whichkey
      local function buf_set_keymap(...) vim.api.nvim_buf_set_keymap(bufnr, ...) end
      local opts = { noremap=true, silent=true }
      buf_set_keymap('n', "gD", "<cmd>lua vim.lsp.buf.declaration()<CR>", opts)
      buf_set_keymap('n', "gd", "<cmd>lua vim.lsp.buf.definition()<CR>", opts)
      buf_set_keymap('n', "K", "<cmd>lua vim.lsp.buf.hover()<CR>", opts)
      buf_set_keymap('n', "gi", "<cmd>lua vim.lsp.buf.implementation()<CR>", opts)
      buf_set_keymap('n', "<C-k>", "<cmd>lua vim.lsp.buf.signature_help()<CR>", opts)
      buf_set_keymap('n', "<leader>wa", "<cmd>lua vim.lsp.buf.add_workspace_folder()<CR>", opts)
      buf_set_keymap('n', "<leader>wr", "<cmd>lua vim.lsp.buf.remove_workspace_folder()<CR>", opts)
      buf_set_keymap('n', "<leader>wl", "<cmd>lua print(vim.inspect(vim.lsp.buf.list_workspace_folders()))<CR>", opts)
      buf_set_keymap('n', "<leader>D", "<cmd>lua vim.lsp.buf.type_definition()<CR>", opts)
      buf_set_keymap('n', "<leader>rn", "<cmd>lua vim.lsp.buf.rename()<CR>", opts)
      buf_set_keymap('n', "<leader>ca", "<cmd>lua vim.lsp.buf.code_action()<CR>", opts)
      buf_set_keymap('n', "gr", "<cmd>lua vim.lsp.buf.references()<CR>", opts)
      buf_set_keymap('n', "<leader>e", "<cmd>lua vim.lsp.diagnostic.show_line_diagnostics()<CR>", opts)
      buf_set_keymap('n', "[d", "<cmd>lua vim.lsp.diagnostic.goto_prev()<CR>", opts)
      buf_set_keymap('n', "]d", "<cmd>lua vim.lsp.diagnostic.goto_next()<CR>", opts)
      buf_set_keymap('n', "<leader>q", "<cmd>lua vim.lsp.diagnostic.set_loclist()<CR>", opts)
      buf_set_keymap('n', "<leader>cf", "<cmd>lua vim.lsp.buf.formatting()<CR>", opts)
    end

    -- Enable some language servers with the additional completion capabilities offered by nvim-cmp
    local servers = {
      "texlab",
      "bashls",
      "ccls",
      "pyright",
      "denols", -- JS and TS
      "yamlls"
    }
    local nvim_lsp = require "lspconfig"
    for _, lsp in ipairs(servers) do
      nvim_lsp[lsp].setup {
        on_attach = on_attach,
        capabilities = capabilities,
      }
    end

    -- Rust LSP
    require"rust-tools".setup({
      server = {
        on_attach = on_attach,
        capabilities = capabilities,
        settings = {
          ["rust-analyzer"] = {
            checkOnSave = { command = "clippy" }
          }
        }
      }
    })

    -- HTML, CSS, JSON LSP
    nvim_lsp.html.setup {
      cmd = {"html-languageserver", "--stdio"},
      on_attach = on_attach,
      capabilities = capabilities,
    }
    nvim_lsp.cssls.setup {
      cmd = {"css-languageserver", "--stdio"},
      on_attach = on_attach,
      capabilities = capabilities,
    }
    nvim_lsp.jsonls.setup {
      cmd = {"vscode-json-languageserver", "--stdio"},
      on_attach = on_attach,
      capabilities = capabilities,
    }

    local luasnip = require "luasnip"

    -- nvim-cmp setup
    local cmp = require "cmp"
    cmp.setup {
      snippet = {
        expand = function(args)
          require"luasnip".lsp_expand(args.body)
        end,
      },
      mapping = {
        ["<C-p>"] = cmp.mapping.select_prev_item(),
        ["<C-n>"] = cmp.mapping.select_next_item(),
        ["<C-u>"] = cmp.mapping.scroll_docs(-4),
        ["<C-d>"] = cmp.mapping.scroll_docs(4),
        ["<C-Space>"] = cmp.mapping.complete(),
        ["<C-e>"] = cmp.mapping.close(),
        ["<CR>"] = cmp.mapping.confirm {
          behavior = cmp.ConfirmBehavior.Replace,
          select = true,
        },
        ["<Tab>"] = function(fallback)
          if cmp.visible() then
            cmp.select_next_item()
          elseif luasnip.expand_or_jumpable() then
            vim.fn.feedkeys(vim.api.nvim_replace_termcodes("<Plug>luasnip-expand-or-jump", true, true, true), "")
          else
            fallback()
          end
        end,
        ["<S-Tab>"] = function(fallback)
          if cmp.visible() then
            cmp.select_prev_item()
          elseif luasnip.jumpable(-1) then
            vim.fn.feedkeys(vim.api.nvim_replace_termcodes("<Plug>luasnip-jump-prev", true, true, true), "")
          else
            fallback()
          end
        end,
      },
      sources = {
        { name = "nvim_lsp" },
        { name = "luasnip" },
        { name = "orgmode" }
      },
    }
  end
}
#+END_SRC

* TODO inspirations
  + ~use { "michaelb/sniprun", run = "bash ./install.sh"}~ TODO shortcut
  + [[https://github.com/rockerBOO/awesome-neovim][Awesome Neovim]]
  + [[https://github.com/NTBBloodbath/doom-nvim/blob/main/docs/modules.md][Doom Nvim]]

* Plugins

Manage plugins with [[https://github.com/wbthomason/packer.nvim][packer]]

#+BEGIN_SRC lua :noweb tangle
local packer = require "packer"

packer.startup(
  function()
    <<plugins>>
  end
)
#+END_SRC

Compile packages (LuaJIT) after being installed

#+BEGIN_SRC lua :exports none
vim.cmd [[
#+END_SRC
#+BEGIN_SRC vimrc
augroup init
au!
autocmd User PackerComplete PackerCompile
augroup END
#+END_SRC
#+BEGIN_SRC lua :exports none
]]
#+END_SRC

Automatically setup packages at first run

#+BEGIN_SRC lua :noweb tangle
if(os.execute("[ -f ~/.config/nvim/plugin/packer_compiled.lua ]") ~= 0)
  then
    packer.sync()
  end
#+END_SRC

